const fitnessFunction = require('./Fitness');
const Braian = require("../../src/br.ai.ann");

const theMysticalXOR = [
	{
		input: [0, 0],
		expected: [0]
	},
	{
		input: [0, 1],
		expected: [1]
	},
	{
		input: [1, 0],
		expected: [1]
	},
	{
		input: [1, 1],
		expected: [0]
	},
];


//This brain is a brain evolved with backpropagation, the genetic algo is beating this guy
//consistently
let theOldBrain = [
	[
		{"weights":[5.15027931382266,5.148688947951809],"bias":-1.234788356102831},
		{"weights":[-3.990454914010234,-3.989954176324832],"bias":5.627691711130935}
	],
	[
		{"weights":[-4.961157827346999,0.40189493185344466],"bias":1.5078298699092365},
		{"weights":[1.3534698819879896,1.7142285910266037],"bias":-0.8189803656967147},
		{"weights":[-2.202371828807682,-0.9902491910591523],"bias":1.0118189797331294},
		{"weights":[-5.617671015306973,1.595044606641634],"bias":0.7521576811531848},
		{"weights":[-2.328978693618989,-2.097859570201634],"bias":2.3285911625132965},
		{"weights":[1.4147613330133701,-8.143160940364098],"bias":1.8516824447993816}
	],
	[
		{"weights":[-5.1402498338182125,5.478580288688524,-2.5587934782073942,-5.547260939714908,-4.499553427961734,-9.68045701236518],"bias":2.571316659159859}
	]
];

//Few brains
theOldBrain = [[{"weights":[7.121147505170819,-11.598202388940445],"bias":-1.1658258913616524},{"weights":[-14.037308522027125,-2.7077996307740664],"bias":7.907890742902908}],[{"weights":[65.48337828770092,-11.310884323934125],"bias":3.7485816493339565},{"weights":[10.929789924121472,14.651909644218797],"bias":14.834112563146135},{"weights":[9.171940689446718,8.907910309447848],"bias":-3.790339858414253},{"weights":[14.905871687296196,-1.5269819344248954],"bias":-8.800788222456672},{"weights":[8.77009403188807,-2.7962569983427232],"bias":-4.228683915857165},{"weights":[-14.780733899976823,-5.36728061382902],"bias":13.423570962957731}],[{"weights":[-72.88622501953989,-3.6754697627963404,4.396056336126299,60.35610496025146,13.703858363130758,-1.1542627574115352],"bias":36.42012358838923}]];
theOldBrain = [[{"weights":[10.913995853949194,-10.94156805637241],"bias":3.943373507345159},{"weights":[-8.022738785368054,6.22323587601422],"bias":4.4879979117926885}],[{"weights":[0,3.1770325353733426],"bias":-1.0448241653080845},{"weights":[-12.47395243534219,7.428929033715293],"bias":-2.333491113436179},{"weights":[-2.332543787486296,11.081997232189366],"bias":9.263696606168308},{"weights":[-12.15332644072643,9.741205547184991],"bias":8.890662796658622},{"weights":[10.273872907418994,-14.256067635927849],"bias":-4.363473946700025},{"weights":[-15.071764011188026,-10.951476525545704],"bias":4.858423789397866}],[{"weights":[-4.572285326635891,77.0509605744516,0,-19.084222289715886,58.88837310264382,-12.080326186980749],"bias":-13.962207368180882}]];
theOldBrain = [[{"weights":[-8.99217774346494,3.9876250039784034],"bias":-6.2112411299943755},{"weights":[-10.832989732184423,12.99109745015017],"bias":-2.0945102718170765}],[{"weights":[1.3272093243442464,-13.341331528025627],"bias":-9.059436631205532},{"weights":[13.148680350697099,3.983619623499703],"bias":12.74254105576545},{"weights":[-5.176537259522472,-14.916341156894319],"bias":14.989888985238894},{"weights":[-13.847958407875238,5.551647401449175],"bias":4.617075248956817},{"weights":[10.773515843957462,-3.9840101744431817],"bias":-10.797986883970044},{"weights":[-6.2501931804928335,-15.65375311236289],"bias":-0.9082205193452487}],[{"weights":[6.825496152344457,-1.4968973076006855,-6.004439367082178,-2.1320895163932403,14.9659499392984,6.44988082687934],"bias":-4.902092978355142},{"weights":[11.242496997991292,-9.204002038652026,11.513553361624194,-12.2429805223547,7.952113199548285,-9.664891203861046],"bias":-11.99188755707201},{"weights":[15.3548523692877,-10.427240556662591,-4.586915068403969,8.41208574704587,-7.405152332307268,4.398241675439553],"bias":-5.108826870563428},{"weights":[-13.967196548435789,10.699591306801407,1.354018965707857,6.255184010314491,-15.035600106350744,9.319934893709984],"bias":11.672008712091591},{"weights":[4.219831743135564,-8.45914442929808,17.111753506638987,13.103627610009834,-2.5040813991586246,-1.3820721142754075],"bias":0},{"weights":[-4.572709603190957,2.133800288726698,15.544054590743665,-4.57864981589325,11.259286843598526,-6.548519321163541],"bias":-12.232034633688704}],[{"weights":[4.366880803484558,10.48181953884422,9.61838444204977,3.9145194972377872,2.3409530105299186,-4.824775964263691],"bias":-7.260965891600438},{"weights":[-6.817012919819787,7.41508019141752,0,-8.989204858956121,5.331707968241166,14.359010906762414],"bias":-2.1395832990983217},{"weights":[10.16638952908227,-2.312921354493651,10.18059486431322,2.2275548321391168,-8.693146252192692,4.769844264892601],"bias":-1.0267046851152395},{"weights":[-1.1585422804617733,10.576033113843096,3.276149999913392,-5.086246054431995,0,-10.526936869665754],"bias":9.091205623903008},{"weights":[-11.577314051446836,12.000517765218047,-10.210169874276769,2.138068673619953,5.01817077479313,9.170149743720259],"bias":11.63426584569957},{"weights":[3.439501002582488,0,6.882443364427211,-7.088179395807815,-2.202409271430121,1.2414980213683795],"bias":-6.74612995963481}],[{"weights":[-1.0601450530427077,-3.056928778268606,-11.143389305676056,12.303227198014184,7.065052060408093,-2.251640199362334],"bias":-10.59930882324921},{"weights":[4.28384274000211,7.995977796808964,-5.357471394288296,-2.1639941099222617,-4.423899241295513,-8.151060122163814],"bias":1.1486834040628173},{"weights":[6.686033583405634,10.032080063287564,7.422485170342584,1.0806992426480897,0,-5.741682508373953],"bias":-0.9601138008},{"weights":[8.70703384511024,3.026365635848559,5.937030237600001,9.651482128438248,-9.74329176288505,0],"bias":1.2071570742728952},{"weights":[4.729699212856027,8.149413443351259,-2.1009817208159998,-5.458622845355697,5.759507680855557,-6.1157169179204445],"bias":-2.0595800221999196},{"weights":[3.7970950731574975,0,-9.850421137190827,11.027520899708477,-1.0506989196,8.308228973066756],"bias":-5.3564210641640155}],[{"weights":[14.35901004493451,-30.79665513184467,-2.3166117588922464,19.85813385902398,-9.732429272934832,11.999341359202441],"bias":4.362969115821616}]];
theOldBrain = [[{"weights":[7.176129934292827,5.74109702676256],"bias":-9.217875799593926},{"weights":[3.7655257524101837,4.107632379502649],"bias":-2.363908466757174}],[{"weights":[-1.0812376886296837,5.985650855781982],"bias":5.572263193108728},{"weights":[-4.502388660031851,-12.010219332108004],"bias":-11.65816707455488},{"weights":[1.0493315735016715,-4.639279466766152],"bias":5.22247177231629},{"weights":[7.603319475060624,-16.55170284765216],"bias":8.12229550021777},{"weights":[-7.681657397503247,5.43076452302056],"bias":-1.1029683264701506},{"weights":[3.5462173218679465,0],"bias":-1.0811294999714194}],[{"weights":[12.263884578670668,-3.4429222488865348,-6.621795878618871,10.385224197764673,1.9188798337871709,-6.482859578140626],"bias":12.871480828946426},{"weights":[3.0554126614504065,2.2737062733160838,2.991909443783527,11.246901509374476,-8.654272634969685,1.136057441789397],"bias":-3.656610355970725},{"weights":[0,-3.5093437204734763,7.950000467093834,12.001837630632336,-9.268374771958765,2.2709744418572635],"bias":-8.46396995992262},{"weights":[-1.1360574417893972,-7.5956942441851325,-1.148223930701192,-11.141160739248816,-8.146968374811395,7.2415224696675145],"bias":0},{"weights":[-3.209034654805175,11.416961577161645,6.10656106175163,-9.463183699191731,12.244274133534752,-3.21384630531821],"bias":-4.113387873920304},{"weights":[-1.1370850910916903,10.083829822299085,-10.879113593264416,-2.3428407474913215,10.121199137301184,-10.18157228702358],"bias":-11.70602861958095}],[{"weights":[-9,6,0.9999,7.92,8,7],"bias":-4},{"weights":[-2,9,10,4,-10,-6],"bias":7},{"weights":[0,-1,10.89,8,-10,3],"bias":8},{"weights":[-8,1,11,4.08,-3,1],"bias":11},{"weights":[-6,-2,-9,4,5,-5],"bias":5},{"weights":[10,-6,11,-10,11,1.02],"bias":2}],[{"weights":[-4.029907491142907,-25.497166516951904,-11.42966183130853,-11.820724406226491,37.548834549070136,6.288424883432294],"bias":4.3254594504505945}]];


console.log(JSON.stringify(theOldBrain));
const braianSon = new Braian.Brain(theOldBrain);
theMysticalXOR.forEach(myCase => {
	let result = braianSon.input(myCase.input);
	let approx_result = Math.round(result,2);
	console.log( `[${myCase.input}] => ${myCase.expected[0]}, got [${approx_result}] = ${result} `);
});


//use prime numbers as they work better for everything
//if you don't want to use primes (screw you!) try to
//use 42.
//the first number is the starting population
//the second is the number of generation that we
//are waiting before stopping
//the evolution if nothing better is spawned
//don't forget the fitness function
const BraveNewWorld = new Braian.Population(53,1511,fitnessFunction);
BraveNewWorld.evolve();

